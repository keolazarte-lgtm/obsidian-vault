<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OBSIDIAN | Private Vault</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
    <style>
        :root { --accent: #9A00FF; --bg: #000; --border: #1a1a1a; --card: #0a0a0a; }
        
        /* RESET & BASE */
        body { 
            background: radial-gradient(circle at center, #1a0033 0%, #000 90%); 
            color: #fff; font-family: 'Inter', sans-serif; margin: 0; padding: 0;
            height: 100vh; overflow: hidden;
        }

        /* LOGIN LAYER */
        #login-view { 
            position: fixed; inset: 0; background: #000; z-index: 10000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .diamond-logo { width: 80px; height: 80px; border: 2px solid var(--accent); transform: rotate(45deg); display: flex; align-items: center; justify-content: center; margin-bottom: 40px; box-shadow: 0 0 30px rgba(154,0,255,0.3); }
        .diamond-logo span { transform: rotate(-45deg); font-family: 'Cinzel'; font-size: 35px; color: var(--accent); }
        .login-input-wrap { width: 280px; border-bottom: 1px solid #333; position: relative; display: flex; align-items: center; }
        .login-input { background: none; border: none; color: var(--accent); width: 100%; padding: 15px; outline: none; text-align: center; letter-spacing: 5px; font-size: 18px; }

        /* HEADER & STORIES */
        .top-nav { position: fixed; top: 0; width: 100%; height: 60px; background: rgba(0,0,0,0.9); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; box-sizing: border-box; z-index: 1000; }
        .stories-bar { display: flex; gap: 15px; padding: 15px; overflow-x: auto; margin-top: 60px; background: rgba(0,0,0,0.3); border-bottom: 1px solid var(--border); }
        .story-node { min-width: 65px; height: 65px; border-radius: 50%; border: 2px solid var(--accent); padding: 2px; position: relative; }
        .story-node img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
        .story-plus { position: absolute; bottom: 0; right: 0; background: var(--accent); width: 20px; height: 20px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 2px solid #000; font-size: 10px; }

        /* MAIN APP SCROLL AREA */
        .main-scroll { height: 100vh; overflow-y: auto; padding-bottom: 100px; scrollbar-width: none; }
        .post-card { background: var(--card); border-bottom: 8px solid #000; width: 100%; }

        /* EDITOR PRO (MODAL) */
        #editor-view { position: fixed; inset: 0; background: #000; z-index: 9000; display: none; flex-direction: column; }
        .editor-header { height: 60px; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; border-bottom: 1px solid var(--border); }
        .canvas-container { flex: 1; position: relative; display: flex; align-items: center; justify-content: center; background: #050505; overflow: hidden; }
        #media-render { max-width: 100%; max-height: 100%; }
        .draggable-text { position: absolute; color: white; font-weight: bold; font-size: 28px; text-shadow: 0 0 10px #000; cursor: move; touch-action: none; z-index: 10; }

        /* SETTINGS VIEW */
        .settings-view { padding: 80px 20px; display: none; }
        .setting-box { background: var(--card); border-radius: 15px; border: 1px solid var(--border); padding: 15px; margin-bottom: 15px; }
        .logout-btn { color: #ff4444; border: 1px solid #301010; padding: 15px; border-radius: 12px; text-align: center; font-weight: bold; cursor: pointer; }

        /* BOTTOM NAV */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; height: 70px; background: #000; border-top: 1px solid var(--border); display: flex; justify-content: space-around; align-items: center; z-index: 1000; }
        .nav-btn { font-size: 22px; color: #444; cursor: pointer; }
        .nav-btn.active { color: var(--accent); }
        .nav-add { width: 50px; height: 50px; background: #fff; color: #000; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; margin-bottom: 20px; box-shadow: 0 0 15px rgba(255,255,255,0.2); }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div id="login-view">
        <div class="diamond-logo"><span>풜</span></div>
        <div class="login-input-wrap">
            <input type="password" id="access-key" class="login-input" placeholder="ACCESS KEY">
            <button onclick="toggleKey()" style="position:absolute; right:10px; background:none; border:none; color:#555; font-size:10px; font-weight:bold;">SHOW</button>
        </div>
        <button onclick="checkAccess()" style="margin-top:50px; background:none; border:none; color:var(--accent); font-size:35px; cursor:pointer;"><i class="fas fa-arrow-right"></i></button>
    </div>

    <div id="app-content" class="hidden">
        <div class="top-nav">
            <i class="fas fa-bars"></i>
            <span style="font-family:'Cinzel'; letter-spacing:5px; color:var(--accent);">OBSIDIAN</span>
            <img src="https://i.pravatar.cc/100?u=1" style="width:32px; height:32px; border-radius:50%; border:1px solid var(--accent);">
        </div>

        <div class="main-scroll" id="home-view">
            <div class="stories-bar">
                <div class="story-node" onclick="openFile()">
                    <img src="https://i.pravatar.cc/100?u=1" style="opacity:0.4;">
                    <div class="story-plus"><i class="fas fa-plus"></i></div>
                </div>
            </div>
            <div id="feed-items" style="padding-top:100px; text-align:center; color:#222; font-family:'Cinzel';">THE VAULT IS EMPTY</div>
        </div>

        <div class="settings-view" id="settings-view">
            <h2 style="font-family:'Cinzel'; margin-bottom:30px;">SETTINGS</h2>
            <div class="setting-box">
                <div style="display:flex; justify-content:space-between;">
                    <span>Language / Idioma</span>
                    <select style="background:none; color:#fff; border:none;"><option>Espa침ol</option><option>English</option></select>
                </div>
            </div>
            <div class="logout-btn" onclick="location.reload()">CERRAR SESI칍N</div>
        </div>

        <nav class="bottom-nav">
            <i class="fas fa-home nav-btn active" onclick="switchTab('home')"></i>
            <i class="fas fa-search nav-btn"></i>
            <div class="nav-add" onclick="openFile()"><i class="fas fa-plus"></i></div>
            <i class="fas fa-envelope nav-btn"></i>
            <i class="fas fa-cog nav-btn" onclick="switchTab('settings')"></i>
        </nav>
    </div>

    <div id="editor-view">
        <div class="editor-header">
            <i class="fas fa-times" onclick="closeEditor()" style="font-size:20px;"></i>
            <span style="font-family:'Cinzel'; font-size:12px;">PRO EDITOR</span>
            <button onclick="publish()" style="background:var(--accent); border:none; color:#fff; padding:8px 15px; border-radius:20px; font-weight:bold;">PUBLICAR</button>
        </div>
        <div class="canvas-container" id="canvas">
            <div id="media-box"></div>
            <div id="float-text" class="draggable-text hidden">NUEVO TEXTO</div>
        </div>
        <div style="background:#080808; padding:20px; border-top:1px solid var(--border);">
            <div style="display:flex; justify-content:space-around; margin-bottom:20px;">
                <i class="fas fa-font" style="font-size:20px;" onclick="addText()"></i>
                <i class="fas fa-smile" style="font-size:20px;" onclick="addEmoji()"></i>
                <i class="fas fa-lock" id="prem-btn" style="font-size:20px;" onclick="togglePremium()"></i>
            </div>
            <input type="text" placeholder="A침adir descripci칩n al post..." style="width:100%; background:#111; border:1px solid #222; color:#fff; padding:15px; border-radius:10px;">
        </div>
    </div>

    <input type="file" id="file-input" hidden accept="image/*,video/*" onchange="handleFile(event)">

    <script>
        // SISTEMA DE NAVEGACI칍N
        function switchTab(tab) {
            document.getElementById('home-view').style.display = tab === 'home' ? 'block' : 'none';
            document.getElementById('settings-view').style.display = tab === 'settings' ? 'block' : 'none';
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            if(tab === 'home') document.querySelector('.fa-home').classList.add('active');
            if(tab === 'settings') document.querySelector('.fa-cog').classList.add('active');
        }

        // LOGIN FUNCIONAL
        function toggleKey() {
            const p = document.getElementById('access-key');
            p.type = p.type === 'password' ? 'text' : 'password';
        }

        function checkAccess() {
            // Aqu칤 Leo conectar치 con Supabase
            document.getElementById('login-view').classList.add('hidden');
            document.getElementById('app-content').classList.remove('hidden');
        }

        // EDITOR DE MEDIOS
        function openFile() { document.getElementById('file-input').click(); }

        function handleFile(e) {
            const file = e.target.files[0];
            const box = document.getElementById('media-box');
            box.innerHTML = '';
            const reader = new FileReader();
            reader.onload = function(f) {
                if(file.type.includes('video')) {
                    const v = document.createElement('video');
                    v.src = f.target.result; v.id = 'media-render'; v.autoplay = true; v.loop = true; v.muted = true;
                    box.appendChild(v);
                } else {
                    const i = document.createElement('img');
                    i.src = f.target.result; i.id = 'media-render';
                    box.appendChild(i);
                }
                document.getElementById('editor-view').style.display = 'flex';
            }
            reader.readAsDataURL(file);
        }

        function addText() {
            const val = prompt("Ingresa el texto:");
            if(val) {
                const el = document.getElementById('float-text');
                el.innerText = val;
                el.classList.remove('hidden');
            }
        }

        function addEmoji() {
            const el = document.getElementById('float-text');
            el.innerText += " 游댠";
            el.classList.remove('hidden');
        }

        function togglePremium() {
            const btn = document.getElementById('prem-btn');
            btn.style.color = btn.style.color === 'rgb(154, 0, 255)' ? '#555' : 'var(--accent)';
        }

        function closeEditor() { document.getElementById('editor-view').style.display = 'none'; }
        function publish() { alert("Subiendo archivo..."); closeEditor(); }

        // TEXTO MOVIBLE (PROFESIONAL)
        interact('.draggable-text').draggable({
            listeners: {
                move (event) {
                    const target = event.target;
                    const x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
                    const y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
                    target.style.transform = `translate(${x}px, ${y}px)`;
                    target.setAttribute('data-x', x);
                    target.setAttribute('data-y', y);
                }
            }
        });
    </script>
</body>
</html>
